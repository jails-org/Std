(function(t,r){typeof exports=="object"&&typeof module!="undefined"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(t=typeof globalThis!="undefined"?globalThis:t||self,r(t.mfe={}))})(this,function(t){"use strict";var b=Object.defineProperty;var S=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var T=(t,r,c)=>r in t?b(t,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[r]=c,p=(t,r)=>{for(var c in r||(r={}))g.call(r,c)&&T(t,c,r[c]);if(S)for(var c of S(r))E.call(r,c)&&T(t,c,r[c]);return t};const r=({timeout:e=5e3}={})=>{const m={};return{renderJS({target:l,tag:i,src:s}){return l.innerHTML=`<${i}></${i}>`,new Promise((n,h)=>{const a=document.createElement("script");a.src=s,a.async=!0,a.onload=()=>n(l),a.onerror=u=>h({type:"error",message:`[mfe] - ${u.type} loading script`}),document.head.appendChild(a)})},render(l,i){return l?fetch(i).then(s=>s.text()).then(s=>{const n=[],h=new URL(i),u=new DOMParser().parseFromString(s,"text/html"),f=u.documentElement.querySelector("body");if(!m[i]){const w=f.querySelectorAll('script, link[rel="stylesheet"], style'),d=u.documentElement.querySelector("head");w.forEach(o=>{d.appendChild(o)}),d.querySelectorAll('link[rel="stylesheet"], style, script').forEach(o=>{if(o.localName=="script"&&o.src){const _=document.createElement("script");_.setAttribute("type","module"),_.setAttribute("src",o.getAttribute("src")),y(_,h,n,e),document.head.appendChild(_)}else y(o,h,n,e),document.head.appendChild(o)}),m[i]=n}return new Promise((w,d)=>{Promise.all(m[i]).then(()=>{l.innerHTML=f==null?void 0:f.innerHTML,w(l)}).catch(o=>{d({type:"error",message:"[mfe] - Unexpected error : "+o})})})}).catch(s=>{throw s}):new Promise((s,n)=>{throw{type:"not-found",data:{target:l,path:i},message:"[mfe] - Target not found"}})}}},c=(e={})=>window.___Shell___?(window.___Shell___=p(p({},e),window.___Shell___),window.___Shell___):(window.___Shell___=p({},e),window.___Shell___),y=(e,m,l,i)=>{if(e.src&&e.getAttribute("src").startsWith("/")){const{pathname:s,search:n}=new URL(e.src);e.src=m.origin+s+n}else if(e.href&&e.getAttribute("href").startsWith("/")){const{pathname:s,search:n}=new URL(e.href);e.href=m.origin+s+n}return(e.src||e.href&&e.rel=="stylesheet")&&l.push(new Promise((s,n)=>{const h=setTimeout(()=>{n({type:"error",message:`[mfe] - Timeout exceeded ${e} resolving after milisseconds.`})},i);e.addEventListener("load",()=>{clearTimeout(h),s(e)}),e.addEventListener("error",()=>{clearTimeout(h),n({type:"error",message:`[mfe] - Error to fetch : ${e.src}`})})})),l};t.Shell=c,t.mfe=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});

(function(r,t){typeof exports=="object"&&typeof module!="undefined"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):(r=typeof globalThis!="undefined"?globalThis:r||self,t(r.mfe={}))})(this,function(r){"use strict";var g=Object.defineProperty;var S=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var b=(r,t,n)=>t in r?g(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,p=(r,t)=>{for(var n in t||(t={}))T.call(t,n)&&b(r,n,t[n]);if(S)for(var n of S(t))E.call(t,n)&&b(r,n,t[n]);return r};const t=({timeout:e=5e3}={})=>{const a={};return{renderJS({target:o,tag:i,src:s}){return o.innerHTML=`<${i}></${i}>`,new Promise((c,h)=>{const m=document.createElement("script");m.src=s,m.async=!0,m.onload=()=>c(o),m.onerror=u=>h({type:"error",message:`[mfe] - ${u.type} loading script`}),document.head.appendChild(m)})},render(o,i){return fetch(i).then(s=>s.text()).then(s=>{const c=[],h=new URL(i),u=new DOMParser().parseFromString(s,"text/html"),_=u.documentElement.querySelector("body");if(!a[i]){const y=_.querySelectorAll('script, link[rel="stylesheet"], style'),d=u.documentElement.querySelector("head");y.forEach(l=>{d.appendChild(l)}),d.querySelectorAll('link[rel="stylesheet"], style, script').forEach(l=>{if(l.localName=="script"&&l.src){const f=document.createElement("script");f.setAttribute("type","module"),f.setAttribute("src",l.getAttribute("src")),w(f,h,c,e),document.head.appendChild(f)}else w(l,h,c,e),document.head.appendChild(l)}),a[i]=c}return new Promise((y,d)=>{Promise.all(a[i]).then(()=>{o.innerHTML=_==null?void 0:_.innerHTML,y(o)}).catch(l=>{d({type:"error",message:"[mfe] - Unexpected error : "+l})})})}).catch(s=>{throw s})}}},n=(e={})=>window.___Shell___?(window.___Shell___=p(p({},e),window.___Shell___),window.___Shell___):(window.___Shell___=p({},e),window.___Shell___),w=(e,a,o,i)=>{if(e.src&&e.getAttribute("src").startsWith("/")){const{pathname:s,search:c}=new URL(e.src);e.src=a.origin+s+c}else if(e.href&&e.getAttribute("href").startsWith("/")){const{pathname:s,search:c}=new URL(e.href);e.href=a.origin+s+c}return(e.src||e.href&&e.rel=="stylesheet")&&o.push(new Promise((s,c)=>{const h=setTimeout(()=>{c({type:"error",message:`[mfe] - Timeout exceeded ${e} resolving after milisseconds.`})},i);e.addEventListener("load",()=>{clearTimeout(h),s(e)}),e.addEventListener("error",()=>{clearTimeout(h),c({type:"error",message:`[mfe] - Error to fetch : ${e.src}`})})})),o};r.Shell=n,r.mfe=t,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});

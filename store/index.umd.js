(function(i,l){typeof exports=="object"&&typeof module!="undefined"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(i=typeof globalThis!="undefined"?globalThis:i||self,l(i.store={}))})(this,function(i){"use strict";function l(a,f){let s=[];const c=new Set,d=m(a),y=()=>d,p=n=>{if(n.call)return c.add(n),()=>{c.delete(n)};{const o=(t,{action:e,payload:r})=>{e in n&&n[e].call(null,t,{action:e,payload:r})};return()=>{c.delete(o)}}},h=(n,o)=>(s.push({action:n,payload:o}),new Promise(t=>u(e=>S({action:n,payload:o},t)))),g=n=>new Promise(o=>{p((t,{action:e,payload:r})=>{e in n&&u(b=>{n[e].call(null,t,{action:e,payload:r}),o(t)})})}),S=({action:n,payload:o={}},t)=>{s.forEach(({action:e,payload:r={}})=>{if(!(e in f))console.log(`[Oni] Error -> No action [ ${e} ] found.`);else{const b=f[e].call(null,d,r,{getState:y,subscribe:p,dispatch:h,patternMatch:g});Object.assign(d,b)}}),s.length&&(c.forEach(e=>e(d,{action:n,payload:o})),s=[]),t(d)};return{getState:y,subscribe:p,dispatch:h,patternMatch:g,destroy:()=>c.clear()}}const m=a=>JSON.parse(JSON.stringify(a)),u=typeof window>"u"?a=>a():a=>requestAnimationFrame(a);i.Store=l,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});

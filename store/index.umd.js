(function(o,i){typeof exports=="object"&&typeof module!="undefined"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(o=typeof globalThis!="undefined"?globalThis:o||self,i(o.store={}))})(this,function(o){"use strict";function i(n,p){let d=[];const c=new Set,u=b(n),h=()=>u,l=e=>{if(e.call)return c.add(e),()=>{c.delete(e)}},y=(e,s)=>(d.push({action:e,payload:s}),new Promise(r=>a(t=>m({action:e,payload:s},r)))),g=e=>new Promise(s=>{l((r,{action:t,payload:f})=>{t in e&&a(S=>{e[t].call(null,r,{action:t,payload:f}),s(r)})})}),m=({action:e,payload:s={}},r)=>{d.forEach(({action:t,payload:f={}})=>{if(!(t in p))console.log(`[Oni] Error -> No action [ ${t} ] found.`);else{const S=p[t].call(null,u,f,{getState:h,subscribe:l,dispatch:y,patternMatch:g});Object.assign(u,S)}}),d.length&&(c.forEach(t=>t(u,{action:e,payload:s})),d=[]),r(u)};return{getState:h,subscribe:l,dispatch:y,patternMatch:g,destroy:()=>c.clear()}}const b=n=>JSON.parse(JSON.stringify(n)),a=typeof window=="undefined"?n=>n():n=>requestAnimationFrame(n);o.Store=i,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});

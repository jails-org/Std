(function(r,t){typeof exports=="object"&&typeof module!="undefined"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):(r=typeof globalThis!="undefined"?globalThis:r||self,t(r.mfe={}))})(this,function(r){"use strict";var b=Object.defineProperty;var _=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var g=(r,t,c)=>t in r?b(r,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):r[t]=c,w=(r,t)=>{for(var c in t||(t={}))T.call(t,c)&&g(r,c,t[c]);if(_)for(var c of _(t))E.call(t,c)&&g(r,c,t[c]);return r};const t=e=>window.___Shell___=w(w({},e),window.___Shell___),c=({timeout:e=5e3}={})=>{const h={};return{renderJS({target:o,tag:i,src:s}){return o.innerHTML=`<${i}></${i}>`,new Promise((n,a)=>{const m=document.createElement("script");m.src=s,m.async=!0,m.onload=()=>n(o),m.onerror=u=>a({type:"error",message:`[mfe] - ${u.type} loading script`}),document.head.appendChild(m)})},render(o,i){return fetch(i).then(s=>s.text()).then(s=>{const n=[],a=new URL(i),u=new DOMParser().parseFromString(s,"text/html"),f=u.documentElement.querySelector("body");if(!h[i]){const y=f.querySelectorAll('script, link[rel="stylesheet"], style'),p=u.documentElement.querySelector("head");y.forEach(l=>{p.appendChild(l)}),p.querySelectorAll('link[rel="stylesheet"], style, script').forEach(l=>{if(l.localName=="script"&&l.src){const d=document.createElement("script");d.setAttribute("type","module"),d.setAttribute("src",l.getAttribute("src")),S(d,a,n,e),document.head.appendChild(d)}else S(l,a,n,e),document.head.appendChild(l)}),h[i]=n}return new Promise((y,p)=>{Promise.all(h[i]).then(()=>{o.innerHTML=f==null?void 0:f.innerHTML,y(o)}).catch(l=>{p({type:"error",message:"[mfe] - Unexpected error : "+l})})})}).catch(s=>{throw s})}}},S=(e,h,o,i)=>{if(e.src&&e.getAttribute("src").startsWith("/")){const{pathname:s,search:n}=new URL(e.src);e.src=h.origin+s+n}else if(e.href&&e.getAttribute("href").startsWith("/")){const{pathname:s,search:n}=new URL(e.href);e.href=h.origin+s+n}return(e.src||e.href&&e.rel=="stylesheet")&&o.push(new Promise((s,n)=>{const a=setTimeout(()=>{n({type:"error",message:`[mfe] - Timeout exceeded ${e} resolving after milisseconds.`})},i);e.addEventListener("load",()=>{clearTimeout(a),s(e)}),e.addEventListener("error",()=>{clearTimeout(a),n({type:"error",message:`[mfe] - Error to fetch : ${e.src}`})})})),o};r.Shell=t,r.mfe=c,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});

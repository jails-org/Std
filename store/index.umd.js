(function(n,c){typeof exports=="object"&&typeof module!="undefined"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(n=typeof globalThis!="undefined"?globalThis:n||self,c(n.store={}))})(this,function(n){"use strict";function c(o,y){let s=[];const r=new Set,l=m(o),h=()=>l,d=e=>{if(e.call)return r.add(e),()=>{r.delete(e)};p(e)},g=(e,a)=>(s.push({action:e,payload:a}),new Promise(i=>u(t=>S({action:e,payload:a},i)))),p=e=>new Promise(a=>{d((i,{action:t,payload:f})=>{t in e&&u(b=>{e[t].call(null,i,{action:t,payload:f}),a(i)})})}),S=({action:e,payload:a={}},i)=>{s.forEach(({action:t,payload:f={}})=>{if(!(t in y))console.log(`[Oni] Error -> No action [ ${t} ] found.`);else{const b=y[t].call(null,l,f,{getState:h,subscribe:d,dispatch:g,patternMatch:p});Object.assign(l,b)}}),s.length&&(r.forEach(t=>t(l,{action:e,payload:a})),s=[]),i(l)};return{getState:h,subscribe:d,dispatch:g,patternMatch:p,destroy:()=>r.clear()}}const m=o=>JSON.parse(JSON.stringify(o)),u=typeof window>"u"?o=>o():o=>requestAnimationFrame(o);n.Store=c,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});

(function(n,e){typeof exports=="object"&&typeof module!="undefined"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(n=typeof globalThis!="undefined"?globalThis:n||self,e(n.mfe={}))})(this,(function(n){"use strict";var P=Object.defineProperty;var A=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var E=(n,e,r)=>e in n?P(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,_=(n,e)=>{for(var r in e||(e={}))H.call(e,r)&&E(n,r,e[r]);if(A)for(var r of A(e))k.call(e,r)&&E(n,r,e[r]);return n};var b=(n,e,r)=>new Promise((p,d)=>{var c=t=>{try{s(r.next(t))}catch(a){d(a)}},w=t=>{try{s(r.throw(t))}catch(a){d(a)}},s=t=>t.done?p(t.value):Promise.resolve(t.value).then(c,w);s((r=r.apply(n,e)).next())});const e=({timeout:d=5e3}={})=>{const c={};return{renderJS({target:s,tag:t,src:a}){return s.innerHTML=`<${t}></${t}>`,new Promise((y,u)=>{const h=document.createElement("script");h.src=a,h.async=!0,h.onload=()=>y(s),h.onerror=S=>u({type:"error",message:`[mfe] - ${S.type} loading script`}),document.head.appendChild(h)})},render(s,t){return b(this,null,function*(){if(!s)return new Promise((a,y)=>{throw{type:"not-found",data:{target:s,path:t},message:"[mfe] - Target not found"}});if(c[t])c[t].push({target:s});else{c[t]=[];const a=yield fetch(t).then(o=>o.text()),u=new DOMParser().parseFromString(a,"text/html"),h=u.querySelectorAll('link[rel="stylesheet"], style'),S=u.querySelectorAll("script"),T=new URL(t),L=[];h.forEach(o=>{switch(o.localName){case"link":const l=document.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("href",new URL(o.getAttribute("href")||"",T).href),L.push(new Promise((i,f)=>{l.onload=()=>i(!0),l.onerror=()=>f(new Error(`Failed to load ${l.href}`))})),document.head.appendChild(l);break;case"style":const m=document.createElement("style");m.innerHTML=o.innerHTML,document.head.appendChild(m);break}});const M=[];return S.forEach(o=>{M.push(()=>new Promise((l,m)=>{const i=document.createElement("script");for(const f of o.attributes)i.setAttribute(f.name,f.value);if(o.text){i.text=o.text,document.head.appendChild(i),l(o);return}o.src&&(i.setAttribute("src",new URL(o.getAttribute("src")||"",T).href),i.onload=l,i.onerror=m,document.head.appendChild(i))}))}),new Promise(o=>{Promise.allSettled(L).then(()=>s.innerHTML=u.body.innerHTML).then(()=>p(M)).then(()=>setTimeout(o,1e3)).then(()=>c[t].forEach(({target:l})=>l.innerHTML=u.body.innerHTML))})}})}}},r=(d={})=>window.___Shell___?(window.___Shell___=_(_({},d),window.___Shell___),window.___Shell___):(window.___Shell___=_({},d),window.___Shell___),p=d=>b(null,null,function*(){const c=[];for(const w of d){const s=yield w();c.push(s)}return c});n.Shell=r,n.mfe=e,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));
